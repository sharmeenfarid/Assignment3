!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("@ali/aes-tracker/index",[],t):"object"==typeof exports?exports.AES=t():e.AES=t()}(window,(function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t,n){e.exports=n(1)},function(e,t,n){var o=n(2),i=o.JSON||(o.JSON={stringify:JSON.stringify});e.exports=function(e){return i.stringify.apply(i,arguments)}},function(e,t){var n=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=n)},function(e,t,n){"use strict";n.r(t);var o=n(0),i=n.n(o);function r(e,t){"function"==typeof requestIdleCallback?requestIdleCallback(e,{timeout:t||1e3}):setTimeout(e,0)}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,t=arguments.length>1?arguments[1]:void 0;return t=t||"",e?u(--e,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".charAt(Math.floor(60*Math.random()))+t):t}function c(e,t){for(var n in t)e[n]=t[n];return e}function a(e){return"undefined"!=typeof Promise&&e instanceof Promise}var s=["pid","page_id","env","username","uid","user_type","sid","device_id","net_type","downlink","sdk_version","xreplay_id","origin_url","title","spm_a","spm_b","sr","dpi","pv_id","ua","device_model","device_brand","app_name","app_version","os","os_version"],f=function(e){var t=Object.prototype.toString.call(e);return"[object String]"===t?e:"[object Number]"===t||"[object Boolean]"===t?e.toString():"[object Object]"===t||"[object Array]"===t?i()(e):void 0},l=function(e){var t={};for(var n in e)t[n]=f(e[n]);return t},d=function(e){var t=[];for(var n in e)t.push("".concat(n,"=").concat(encodeURIComponent(f(e[n]))));return t.join("&")};function p(e){return(e.requiredFields||[]).concat(["pid"]).some((function(t){return void 0===e[t]}))}function g(e){this._queue=[],this._reqQueue=[],this._plugins={},this._config={sdk_version:"3.0.0",pv_id:u()},e&&(this._config=c(this._config,e))}g.prototype={constructor:g,_sendAll:function(){if(this._queue.length){var e=this._config.maxUrlLength||3e4,t=this._getSendConfig(),n=this._processData(this._queue,t);if(n.length<e)return this._queue=[],void this.send(n);for(var o,i=[];this._queue.length;)if(i.push(this._queue.shift()),(o=this._processData(i,t)).length>e){i.length>1&&(this._queue.push(i.shift()),o=this._processData(i,t));break}this.send(o),this._queue.length&&this._sendAll()}},_send:function(e,t){!1===t?this.send(this._processData([e])):(this._queue.push(e),r(this._sendAll.bind(this)))},_getSendConfig:function(){var e={},t=this._config;for(var n in t)(s.includes(n)||0===n.indexOf("dim"))&&(t[n]||0===t[n])&&(e[n]=f(t[n]));return e},_processData:function(e,t){t=t||this._getSendConfig();var n=d(t);return n+="&msg="+encodeURIComponent(e.map((function(e){return d(e)})).join("|"))},setConfig:function(e,t){var n=this,o=function(){if(void 0!==t)n._config[e]=t;else for(var o in e)"[object Object]"===Object.prototype.toString.call(e[o])?n._config[o]=c(n._config[o],e[o]):n._config[o]=e[o]};this._reqQueue.length?(o(),p(this._config)||(this._reqQueue.forEach((function(e){n._send.apply(n,e)})),this._reqQueue=[])):(function(){if(void 0!==t)return t!==n._config[e];for(var o in e)if(e[o]!==n._config[o])return!0;return!1}()&&this._sendAll(),o())},getConfig:function(e){return e?this._config[e]:this._config},updatePVID:function(){this.setConfig("pv_id",u())},log:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e&&(t.ts=t.ts||(new Date).getTime(),t.ts=t.ts+"",t.type=e,t=l(t),p(this._config)?this._reqQueue.push([t,n.combo]):this._send(t,n.combo))},before:function(e,t){var n=this;return function(){var o=arguments,i=t.apply(n,o);a(i)?i.then((function(t){e.apply(n,t||o)})):e.apply(n,i||o)}},after:function(e,t){var n=this;return function(){var o=arguments;e.apply(n,o),t.apply(n,o)}},use:function(e,t){var n=this;return"[object Array]"===Object.prototype.toString.call(e)?e.map((function(e){if("[object Array]"===Object.prototype.toString.call(e)){var t=e[0],o=e[1];return n._plugins[t]=new t(n,o)}return n._plugins[e]=new e(n)})):this._plugins[e]||(this._plugins[e]=new e(this,t))}};var h,_=g,v=function(){try{if(window.xr){var e=Array.from(xr.global.recordingContexts.keys());if(e.length>0){var t=xr.global.recordingContexts.get(e[0]);if(t.appKey&&t.recordingId&&t.isRecording)return{appKey:t.appKey,recordingId:t.recordingId}}}}catch(e){}},y=location.href.indexOf("aes_debug")>-1;function m(e){var t=this;this._offlineQueue=[];var n=function(){if(window.goldlog&&goldlog.spm_ab)return goldlog.spm_ab;var e,t=document.querySelector('meta[name="spm-id"]')||document.querySelector('meta[name="data-spm"]');if(t&&(e=t.content)&&-1!==e.indexOf("."))return e.split(".");var n=document.body&&document.body.getAttribute("data-spm");return e&&n?[e,n]:[]}(),o={title:document.title,spm_a:n[0],spm_b:n[1],hash:location.hash,dpi:window.devicePixelRatio,sr:"".concat(window.screen.width,"x").concat(window.screen.height)},i=document.querySelector('meta[name="aes-config"]');if(i)try{var u=i.getAttribute("content");u&&u.split("&").forEach((function(e){var t=e.split("="),n=t[0],i=decodeURIComponent(t[1]);if(-1!==n.indexOf(".")){var r=n.split(".")[0],u=n.split(".")[1];o[r]||(o[r]={}),o[r][u]=i}else o[n]=i}))}catch(e){}window.AES_CONFIG&&(o=c(o,AES_CONFIG)),e&&(o=c(o,e)),_.call(this,o),window.addEventListener("hashchange",(function(){t.setConfig("hash",location.hash)}));var a=navigator.connection||navigator.mozConnection||navigator.webkitConnection;if(a){var s=function(){t.setConfig({downlink:a.downlink,net_type:a.effectiveType}),navigator.onLine&&t._offlineQueue.length&&(t._offlineQueue.forEach((function(e){r((function(){t.send(e)}))})),t._offlineQueue=[])};s(),a.addEventListener("change",s)}try{var f=function(){var e=document.querySelector("title");e&&new MutationObserver((function(){t.setConfig("title",document.title)})).observe(e,{childList:!0,characterData:!0,subtree:!0})};document.querySelector("title")?f():document.addEventListener("DOMContentLoaded",f)}catch(e){}var l="AES_QUEUE";"[object Array]"===Object.prototype.toString.call(window[l])?window[l].forEach((function(e){"function"==typeof e?e(t):t[e.action].apply(t,e.arguments)})):window[l]=[],window[l].push=function(e){"function"==typeof e?e(t):t[e.action].apply(t,e.arguments)}}m.prototype=((h=function(){}).prototype=_.prototype,new h),m.prototype.constructor=m,m.prototype.log=function(){var e,t;if(window.goldlog){var n=goldlog.spm_ab;n&&(this.getConfig("spm_a")!==n[0]&&((t||(t={})).spm_a=n[0]),this.getConfig("spm_b")!==n[1]&&((t||(t={})).spm_b=n[1]))}var o=location.href;o!==this.getConfig("origin_url")&&(t||(t={}),t.origin_url=location.href);var i=v();if(i){var r=i.appKey+","+i.recordingId;this.getConfig("xreplay_id")!==r&&((t||(t={})).xreplay_id=r)}t&&this.setConfig(t),_.prototype.log.apply(this,arguments),y&&(null===(e=window.console)||void 0===e||e.log("[AES] log",arguments))},m.prototype.send=function(e){if(navigator.onLine){var t,n,o=["/aes.1.1","EXP",e,"POST"];null!==(t=window)&&void 0!==t&&null!==(n=t.goldlog)&&void 0!==n&&n.record?(goldlog.record.apply(goldlog,o),y&&console.log("[AES] send",o)):(window.goldlog_queue||(window.goldlog_queue=[]),goldlog_queue.push({action:"goldlog.record",arguments:o}),y&&console.warn("[AES] 未监测到Aplus SDK"))}else this._offlineQueue.length>500&&this._offlineQueue.shift(),this._offlineQueue.push(e)};t.default=m}]).default}));!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("@ali/aes-tracker-plugin-pv/index",[],n):"object"==typeof exports?exports.AESPluginPV=n():e.AESPluginPV=n()}(window,(function(){return function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(o,r,function(n){return e[n]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}([function(e,n,t){"use strict";function o(e,n){for(var t in n)e[t]=n[t];return e}t.r(n);n.default=function(e,n){var t,r,i,u=null===(t=document)||void 0===t?void 0:t.referrer,a=u,f=!0,l=o(o({},e.getConfig("plugin_pv")),n),d=l.autoPV,c=void 0===d||d,p=l.autoLeave,s=void 0===p||p,v=l.enableHistory,y=l.enableHash;function b(e){return{p1:window.parent!==window,p2:e||u}}function g(){f?f=!1:e.updatePVID(),e.log("pv",b()),a=u,u=location.href}function w(){e.log("leave",b(a))}return c&&g(),v&&c?function(e){var n,t,o,r;window.addEventListener("popstate",(function(n){e(n.state)}));var i=null===(n=window)||void 0===n||null===(t=n.history)||void 0===t?void 0:t.pushState;i&&(history.pushState=function(n){i.apply(this,arguments),e(n)});var u=null===(o=window)||void 0===o||null===(r=o.history)||void 0===r?void 0:r.replaceState;u&&(history.replaceState=function(n){u.apply(this,arguments),e(n)})}((function(e){g()})):y&&c&&(r=function(){g()},window.addEventListener("hashchange",(function(){r({page_id:location.hash||"#"})}))),s&&(null===(i=window)||void 0===i||i.addEventListener("beforeunload",(function(){w()}))),{sendPV:g,sendLeave:w,switchPage:function(n){n&&e.setConfig(n),g()}}}}]).default}));!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("@ali/aes-tracker-plugin-event/index",[],t):"object"==typeof exports?exports.AESPluginEvent=t():e.AESPluginEvent=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var r=["ec","ea","el","et"];var o=function(e,t){var n=function(e){var n=e.ec,r=e.ea,o=e.el,l=e.et,u=void 0===l?"CLK":l,i=e.xpath;delete e.ec,delete e.ea,delete e.el,delete e.et,delete e.xpath,e.p1=n,e.p2=r,e.p3=o,e.p4=u,e.p5=i;try{t.log("event",e)}catch(e){}};return function(){var t=arguments,o={};if(0!==t.length){for(var l=0;l<t.length;l++){var u,i,a=t[l];if(0!==l&&"object"==typeof a&&l!==t.length-1)return void(null==e||null===(u=e.console)||void 0===u||null===(i=u.warn)||void 0===i||i.call(u,"[AES tracker-plugin-event]","Only the last argument can be object type"));if("string"==typeof a||"number"==typeof a)o[r[l]]=a;else if("object"==typeof a&&l===t.length-1)for(var f in a)a.hasOwnProperty(f)&&(o[f]=a[f])}n(o)}else{var c,p;null===(c=e.console)||void 0===c||null===(p=c.warn)||void 0===p||p.call(c,"[AES tracker-plugin-event]","At lease one augument")}}};t.default=function(e,t){return o(window,e)}}]).default}));!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("@ali/aes-tracker-plugin-jserror/index",[],t):"object"==typeof exports?exports.AESPluginJSError=t():e.AESPluginJSError=t()}(window,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3)}([function(e,t,r){e.exports=r(1)},function(e,t,r){var n=r(2),o=n.JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return o.stringify.apply(o,arguments)}},function(e,t){var r=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=r)},function(e,t,r){"use strict";r.r(t);var n=r(0),o=r.n(n);function i(e){return e?e.length<10001?e:e.substr(0,9997)+"...":""}function s(e){if(!e||"string"!=typeof e)return"";try{var t=e.split("\n").slice(1).map((function(e){return e.replace(/^\s+at\s+/,"")})).filter((function(e){return!!e}));if(t.join("^").length<=1e5)return t.join("^");for(var r=!1;t.join("^").length>1e5;)if(2===t.length)t.splice(1,1),r=!0;else if(1===t.length){var n=t[0];t[0]="".concat(n.substr(0,997),"...").concat(n.substr(-1e3,1e3))}else t.splice(t.length-2),r=!0;if(t.length>1&&r){var o=t.pop();return t.join("^")+"^...^"+o}return 1===t.length&&r?t[0]+"^...":t.join("^")}catch(e){return""}}function c(e){if("string"==typeof e.message){var t=e.message.match(/Uncaught (\w+):/);if(t&&t[1])return t[1]}return e.error_type?e.error_type:e.name?e.name:e.constructor.name}var u=function(e,t,r){if("object"==typeof e){var n=e.message,o=void 0===n?"":n,u=e.filename,f=e.lineno,a=e.colno,l=e.stack,p=e.error_code,d=void 0===p?"":p,g=e.error,y=(this.getConfig("plugin_jserror")||{}).ignoreList;y&&y.some((function(t){if("string"==typeof t)return t===o;if("function"==typeof t)try{return t(o,e)}catch(e){}else if(t instanceof RegExp)return t.test(o)}))||this.log("js_error",{message:o,url:i(u),lineno:f,colno:a,stack:s(g&&g.stack||l),error_type:c(e),error_code:d})}};function f(e,t,r,n,o){try{return"string"==typeof e?{message:e,filename:t,lineno:r,colno:n,error:o}:e}catch(e){}}function a(e){if(e)try{var t="",r=0,n=0,i="",s="",c="string"==typeof e?e:e.reason,u=this.getConfig("plugin_js_error_processPromiseRejectReason");if("function"==typeof u&&(!1===(c=u(c))||void 0===c||""===c||null===c))return;"string"==typeof e.message&&(t=e.message),"string"==typeof c?t=c:"object"==typeof c&&(t=c.message);try{t||(t="object"==typeof c?o()(c).substr(0,150):t)}catch(e){}if("object"==typeof c){if("number"==typeof c.column)n=c.column,r=c.line;else if(c.stack){(f=c.stack.match(/at\s+.+:(\d+):(\d+)/))&&(r=f[1],n=f[2])}if(c.sourceURL)i=c.sourceURL;else if(c.stack){var f;(f=c.stack.match(/at\s+(.+):\d+:\d+/))&&(i=f[1])}c.stack&&(s=c.stack)}return{message:t,filename:i,lineno:r,colno:n,stack:s,error_type:e.constructor.name}}catch(e){}}function l(e){var t;t="undefined"!=typeof PromiseRejectionEvent&&e instanceof PromiseRejectionEvent?a.apply(this,arguments):f.apply(this,arguments),u.call(this,t)}function p(e,t){for(var r in t)e[r]=t[r];return e}t.default=function(e,t){var r=p(p({},e.getConfig("plugin_jserror")),t);return!r.disable_error&&window.addEventListener("error",l.bind(e)),!r.disable_unhandled_rejection&&window.addEventListener("unhandledrejection",l.bind(e)),{sendError:function(){l.apply(e,arguments)}}}}]).default}));!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("@ali/aes-tracker-plugin-api/index",[],t):"object"==typeof exports?exports.AESPluginAPI=t():e.AESPluginAPI=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=21)}([function(e,t,n){e.exports=!n(6)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t){var n=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=n)},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){e.exports=n(9)},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){var r=n(15),o=n(16),i=n(18),s=Object.defineProperty;t.f=n(0)?Object.defineProperty:function(e,t,n){if(r(e),t=i(t,!0),r(n),o)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){e.exports=n(8)},function(e,t,n){var r=n(1),o=r.JSON||(r.JSON={stringify:JSON.stringify});e.exports=function(e){return o.stringify.apply(o,arguments)}},function(e,t,n){n(10);var r=n(1).Object;e.exports=function(e,t,n){return r.defineProperty(e,t,n)}},function(e,t,n){var r=n(11);r(r.S+r.F*!n(0),"Object",{defineProperty:n(5).f})},function(e,t,n){var r=n(4),o=n(1),i=n(12),s=n(14),a=n(20),c=function(e,t,n){var u,f,p,d=e&c.F,l=e&c.G,y=e&c.S,h=e&c.P,v=e&c.B,g=e&c.W,m=l?o:o[t]||(o[t]={}),w=m.prototype,b=l?r:y?r[t]:(r[t]||{}).prototype;for(u in l&&(n=t),n)(f=!d&&b&&void 0!==b[u])&&a(m,u)||(p=f?b[u]:n[u],m[u]=l&&"function"!=typeof b[u]?n[u]:v&&f?i(p,r):g&&b[u]==p?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(p):h&&"function"==typeof p?i(Function.call,p):p,h&&((m.virtual||(m.virtual={}))[u]=p,e&c.R&&w&&!w[u]&&s(w,u,p)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t,n){var r=n(13);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(5),o=n(19);e.exports=n(0)?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(2);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){e.exports=!n(0)&&!n(6)((function(){return 7!=Object.defineProperty(n(17)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(2),o=n(4).document,i=r(o)&&r(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},function(e,t,n){var r=n(2);e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;if("string"==typeof e)return e.length>t&&(e=e.substr(0,t-3)+"..."),e}n.r(t);var o=function(e,t,n){var o=e.url,i=e.success,s=e.msg,a=e.status,c=e.code,u=e.duration,f=e.traceId,p=e.params,d=e.body,l=e.response,y=e.headers,h=e.rtype,v=e.method,g=n.ignoreList,m=n.sendResponseOnSuccess;g&&g.some((function(t){if("string"==typeof t)return t===o;if("function"==typeof t)try{return t(o,e)}catch(e){}else if(t instanceof RegExp)return t.test(o)}))||t.log("api",{url:o,method:"string"==typeof v?v.toUpperCase():void 0,success:i,msg:s,status:a,code:c,duration:u,trace_id:f,params:p,body:r(d,1e4),response:!i||m?r(l,1e4):void 0,headers:y,rtype:h})};function i(e,t){return(void 0===t||t>=200&&t<300)&&(void 0!==e.success?!0===e.success||"true"===e.success:void 0!==e.isSuccess?!0===e.isSuccess||"true"===e.isSuccess:void 0!==e.isOk?!0===e.isOk||"true"===e.isOk:void 0!==e.ok?!0===e.ok||"true"===e.ok:isNaN(e.status)?!!isNaN(e.code)||200==e.code:200==e.status)}function s(e){return e.code}function a(e){var t=e.msg||e.message||e.errMsg||e.errorMessage||e.errorMsg;return t&&t.length>50&&(t=t.substring(1,50)),t}function c(e,t){if(t=t.toUpperCase(),e&&("POST"===t||"PUT"===t)){if("string"==typeof e)return e;if(window.FormData&&e instanceof FormData){var n=[];return e.forEach((function(e,t){n.push("".concat(t,"=").concat("string"==typeof e?e:Object.prototype.toString.call(e)))})),n.join("&")}return window.URLSearchParams&&e instanceof URLSearchParams?e.toString():window.Request&&e instanceof Request?e.clone().text():Object.prototype.toString.call(e)}}function u(e,t,n,r){var o,c=e;if("string"==typeof c)try{c=JSON.parse(e)}catch(e){}if(o="[object Object]"===Object.prototype.toString.call(c)?{msg:a(c),code:s(c),success:i(c,t)}:{success:void 0===t||t>=200&&t<300},"function"==typeof r.parseResponse)try{var u=r.parseResponse(c,t,n)||{};for(var f in u)o[f]=u[f]}catch(e){}return o}function f(e){return!e||-1!==e.indexOf("api=")&&-1!==e.indexOf("v=")&&-1!==e.indexOf("jsv=")||-1!==e.indexOf(".mmstat.com")||e.match(/\.(js|css|png|jpg|gif|jpeg|webp|ico|svg)(\?.*)?$/)}function p(e){return"undefined"!=typeof Promise&&e instanceof Promise}function d(e,t){for(var n in t)e[n]=t[n];return e}function l(e){if(window.Headers&&e instanceof Headers){var t={};return e.forEach((function(e,n){t[n]=e})),t}if("[object Object]"===Object.prototype.toString.call(e))return e}function y(e,t){if(t.originResponse)return e;if("jsonp"===t.method)return e.text();var n=e.headers&&e.headers.get?e.headers.get("content-type"):null;return n&&-1===n.toLowerCase().indexOf("json")&&-1===n.toLowerCase().indexOf("text")?"[".concat(n,"]"):e.text()}var h=function(e,t){if(!("function"!=typeof window.fetch||window.fetch&&window.fetch.polyfill)){var n=window.fetch;window.fetch=function(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("HEAD"===i.method||"no-cors"===i.mode)return n.apply(window,arguments);var s="object"==typeof r?r.url||r.href:r;if(f(s))return n.apply(window,arguments);var a,h,v=s.split("?"),g=v[0],m=v[1],w=i.method||r.method||"GET";try{h=l(i.headers||r.headers)}catch(e){}try{p(a=c(i.body||r,w))&&a.then((function(e){a=e}))}catch(e){}var b=(new Date).getTime();return n.apply(window,arguments).then((function(n){try{if("[object Response]"!==Object.prototype.toString.call(n))return n;var r,s=(new Date).getTime()-b,c=n.clone?n.clone():n,f=c.status;c.headers.has("eagleeye-traceid")?r=c.headers.get("eagleeye-traceid"):c.headers.has("x-eagleeye-id")&&(r=c.headers.get("x-eagleeye-id"));var l=function(n){!1!==(c=u(n,f,{type:"fetch",params:m,url:g,body:i.body},t)).success&&t.disable_send_on_success||o(d({url:g,method:w,status:f,duration:s,traceId:r,params:m,headers:h,body:a,response:n,rtype:"fetch"},c),e,t)},v=y(c,i);p(v)?v.then(l):l(v)}catch(e){}return n}),(function(e){var n=(new Date).getTime()-b,r=u("",-1,{type:"fetch",params:m,url:g},t);throw o(d({url:g,method:w,success:!1,msg:e.message,status:-1,duration:n,params:m,body:a,headers:h,rtype:"fetch"},r)),e}))}}};var v=function(e,t){if("function"==typeof window.XMLHttpRequest&&window.addEventListener){var n=window.XMLHttpRequest,r=n.prototype,i=r.open,s=r.send,a=r.setRequestHeader;n.prototype.open=function(e,t){i.apply(this,arguments),this._aesHook={method:e,url:t}},n.prototype.setRequestHeader=function(e,t){a.apply(this,arguments),this._aesHook.headers||(this._aesHook.headers={}),this._aesHook.headers[e]=t},n.prototype.send=function(n){s.apply(this,arguments);try{var r=this._aesHook,i=r.url,a=r.method,p=void 0===a?"GET":a,l=r.headers;delete this._aesHook;var y=i?i.href||i:"";if(f(y))return;var h,v=y.split("?"),g=this,m=0,w=v[1],b=(new Date).getTime();i=v[0];try{h=c(n,p)}catch(e){}var x=function(){m=g.status||m;var r,s=(new Date).getTime()-b;try{var a=g.getAllResponseHeaders();-1!==a.indexOf("eagleeye-traceid")?r=g.getResponseHeader("eagleeye-traceid"):-1!==a.indexOf("x-eagleeye-id")&&(r=g.getResponseHeader("x-eagleeye-id"))}catch(e){}var c,f=g.responseType||"text";"text"===f||"json"===f?c=g.response:g.response&&(c=Object.prototype.toString.call(g.response));var y=u(c||"",m,{type:"xhr",params:w,url:i,body:n},t);y.success&&t.disable_send_on_success||o(d({url:i,method:p,status:m,duration:s,traceId:r,params:w,headers:l,body:h,response:c,rtype:"xhr"},y),e,t)};void 0!==g.onloadend?(g.addEventListener("abort",(function(e){m=-2})),g.addEventListener("timeout",(function(e){m=-3})),g.addEventListener("loadend",x)):g.addEventListener("readystatechange",(function(){4===g.readyState&&x()}))}catch(e){}}}},g=n(7),m=n.n(g),w=n(3),b=n.n(w);var x=function(e,t){function n(n){var r=this.options,i=this.params,s=(new Date).getTime();return n().then((function(){var n=r.retJson.ret,a=(new Date).getTime()-s;n instanceof Array&&(n=n.join(","));var c={};if("function"==typeof t.parseResponse)try{c=t.parseResponse(r.retJson,"",{type:"mtop",params:i.data,url:i.api})||{}}catch(e){}var u=void 0===c.success?-1===n.indexOf("SUCCESS"):!c.success;if(u||!t.disable_send_on_success){var f,p,l,y=r.retJson.code||200,h=r.retJson.responseHeaders;if("string"==typeof h){var v=h.match(/(x-eagleeye-id|eagleeye-traceid):\s*([a-z0-9]+)/);v&&(f=v[2]);var g=h.match(/status:\s*(\d+)/);g&&(y=g[1])}if(n){var w=n.split("::");p=w[0],l=w[1]}o(d({url:i.api,success:!u,method:i.type||"GET",msg:l,status:y,code:p,duration:a,traceId:f,params:i.data,response:m()(r.retJson),rtype:"mtop"},c),e,t)}}))}var r;window.lib||(window.lib={}),lib.mtop?lib.mtop.middlewares&&lib.mtop.middlewares.push(n):b()(lib,"mtop",{configurable:!0,set:function(e){var t;(r=e).middlewares?-1===r.middlewares.indexOf(n)&&r.middlewares.push(n):b()(r,"middlewares",{configurable:!0,set:function(e){-1===(t=e).indexOf(n)&&t.push(n)},get:function(){return t}})},get:function(){return r}})};t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t=d(d({},e.getConfig("plugin_api")),t),r=n.disableHook,i=n.disableHookFetch,s=n.disableHookXHR,a=n.disableHookMtop;return!0!==r&&(!0!==i&&h(e,t),!0!==s&&v(e,t),!0!==a&&x(e,t)),{sendApi:function(n){o(n,e,t)}}}}]).default}));!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("@ali/aes-tracker-plugin-resourceError/index",[],r):"object"==typeof exports?exports.AESPluginResourceError=r():e.AESPluginResourceError=r()}(window,(function(){return function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)t.d(n,o,function(r){return e[r]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=0)}([function(e,r,t){"use strict";function n(e){var r,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.ignoreList||(null===(r=e.getConfig("plugin_resourceError"))||void 0===r?void 0:r.ignoreList)||[];n.push((function(e){return!e||-1!==e.indexOf(".mmstat.com")}));var o=function(r){e.log("resource_error",{p1:r.src.substring(0,1e4),p2:r.type,p3:r.status})};return window.addEventListener("error",(function(e){if(!(e instanceof ErrorEvent)){var r,t=e.target,u=t.src||t.href;if(n.some((function(r){if("string"==typeof r)return r===u;if("function"==typeof r)try{return r(u,e)}catch(e){}else if(r instanceof RegExp)return r.test(u)})))return;o({src:u,type:null===(r=t.tagName)||void 0===r?void 0:r.toLowerCase()})}}),!0),{sendError:o}}t.r(r),t.d(r,"default",(function(){return n}))}]).default}));!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("@ali/aes-tracker-plugin-perf/index",[],n):"object"==typeof exports?exports.AESPluginPerf=n():e.AESPluginPerf=n()}(window,(function(){return function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(r,o,function(n){return e[n]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=45)}([function(e,n){var t=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=t)},function(e,n,t){e.exports=!t(4)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,n){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)},function(e,n){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,n){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,n,t){e.exports=t(16)},function(e,n,t){e.exports=t(41)},function(e,n){e.exports=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,n,t){var r=t(42);function o(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),r(e,o.key,o)}}e.exports=function(e,n,t){return n&&o(e.prototype,n),t&&o(e,t),r(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,n,t){var r=t(2),o=t(0),i=t(18),u=t(20),a=t(11),c=function(e,n,t){var s,f,l,p=e&c.F,d=e&c.G,v=e&c.S,m=e&c.P,y=e&c.B,h=e&c.W,g=d?o:o[n]||(o[n]={}),w=g.prototype,b=d?r:v?r[n]:(r[n]||{}).prototype;for(s in d&&(t=n),t)(f=!p&&b&&void 0!==b[s])&&a(g,s)||(l=f?b[s]:t[s],g[s]=d&&"function"!=typeof b[s]?t[s]:y&&f?i(l,r):h&&b[s]==l?function(e){var n=function(n,t,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(n);case 2:return new e(n,t)}return new e(n,t,r)}return e.apply(this,arguments)};return n.prototype=e.prototype,n}(l):m&&"function"==typeof l?i(Function.call,l):l,m&&((g.virtual||(g.virtual={}))[s]=l,e&c.R&&w&&!w[s]&&u(w,s,l)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,n,t){var r=t(21),o=t(22),i=t(24),u=Object.defineProperty;n.f=t(1)?Object.defineProperty:function(e,n,t){if(r(e),n=i(n,!0),r(t),o)try{return u(e,n,t)}catch(e){}if("get"in t||"set"in t)throw TypeError("Accessors not supported!");return"value"in t&&(e[n]=t.value),e}},function(e,n){var t={}.hasOwnProperty;e.exports=function(e,n){return t.call(e,n)}},function(e,n,t){var r=t(13),o=t(14);e.exports=function(e){return r(o(e))}},function(e,n,t){var r=t(29);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,n){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,n){var t=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:t)(e)}},function(e,n,t){t(17),e.exports=t(0).Object.assign},function(e,n,t){var r=t(9);r(r.S+r.F,"Object",{assign:t(26)})},function(e,n,t){var r=t(19);e.exports=function(e,n,t){if(r(e),void 0===n)return e;switch(t){case 1:return function(t){return e.call(n,t)};case 2:return function(t,r){return e.call(n,t,r)};case 3:return function(t,r,o){return e.call(n,t,r,o)}}return function(){return e.apply(n,arguments)}}},function(e,n){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,n,t){var r=t(10),o=t(25);e.exports=t(1)?function(e,n,t){return r.f(e,n,o(1,t))}:function(e,n,t){return e[n]=t,e}},function(e,n,t){var r=t(3);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,n,t){e.exports=!t(1)&&!t(4)((function(){return 7!=Object.defineProperty(t(23)("div"),"a",{get:function(){return 7}}).a}))},function(e,n,t){var r=t(3),o=t(2).document,i=r(o)&&r(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},function(e,n,t){var r=t(3);e.exports=function(e,n){if(!r(e))return e;var t,o;if(n&&"function"==typeof(t=e.toString)&&!r(o=t.call(e)))return o;if("function"==typeof(t=e.valueOf)&&!r(o=t.call(e)))return o;if(!n&&"function"==typeof(t=e.toString)&&!r(o=t.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,n){e.exports=function(e,n){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:n}}},function(e,n,t){"use strict";var r=t(1),o=t(27),i=t(38),u=t(39),a=t(40),c=t(13),s=Object.assign;e.exports=!s||t(4)((function(){var e={},n={},t=Symbol(),r="abcdefghijklmnopqrst";return e[t]=7,r.split("").forEach((function(e){n[e]=e})),7!=s({},e)[t]||Object.keys(s({},n)).join("")!=r}))?function(e,n){for(var t=a(e),s=arguments.length,f=1,l=i.f,p=u.f;s>f;)for(var d,v=c(arguments[f++]),m=l?o(v).concat(l(v)):o(v),y=m.length,h=0;y>h;)d=m[h++],r&&!p.call(v,d)||(t[d]=v[d]);return t}:s},function(e,n,t){var r=t(28),o=t(37);e.exports=Object.keys||function(e){return r(e,o)}},function(e,n,t){var r=t(11),o=t(12),i=t(30)(!1),u=t(33)("IE_PROTO");e.exports=function(e,n){var t,a=o(e),c=0,s=[];for(t in a)t!=u&&r(a,t)&&s.push(t);for(;n.length>c;)r(a,t=n[c++])&&(~i(s,t)||s.push(t));return s}},function(e,n){var t={}.toString;e.exports=function(e){return t.call(e).slice(8,-1)}},function(e,n,t){var r=t(12),o=t(31),i=t(32);e.exports=function(e){return function(n,t,u){var a,c=r(n),s=o(c.length),f=i(u,s);if(e&&t!=t){for(;s>f;)if((a=c[f++])!=a)return!0}else for(;s>f;f++)if((e||f in c)&&c[f]===t)return e||f||0;return!e&&-1}}},function(e,n,t){var r=t(15),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},function(e,n,t){var r=t(15),o=Math.max,i=Math.min;e.exports=function(e,n){return(e=r(e))<0?o(e+n,0):i(e,n)}},function(e,n,t){var r=t(34)("keys"),o=t(36);e.exports=function(e){return r[e]||(r[e]=o(e))}},function(e,n,t){var r=t(0),o=t(2),i=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(e.exports=function(e,n){return i[e]||(i[e]=void 0!==n?n:{})})("versions",[]).push({version:r.version,mode:t(35)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,n){e.exports=!0},function(e,n){var t=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++t+r).toString(36))}},function(e,n){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,n){n.f=Object.getOwnPropertySymbols},function(e,n){n.f={}.propertyIsEnumerable},function(e,n,t){var r=t(14);e.exports=function(e){return Object(r(e))}},function(e,n,t){var r=t(0),o=r.JSON||(r.JSON={stringify:JSON.stringify});e.exports=function(e){return o.stringify.apply(o,arguments)}},function(e,n,t){e.exports=t(43)},function(e,n,t){t(44);var r=t(0).Object;e.exports=function(e,n,t){return r.defineProperty(e,n,t)}},function(e,n,t){var r=t(9);r(r.S+r.F*!t(1),"Object",{defineProperty:t(10).f})},function(e,n,t){"use strict";t.r(n);var r=t(5),o=t.n(r),i=t(6),u=t.n(i),a={},c=null,s=0,f=function(e,n,t){var r=e.name,o=e.startTime,i={"first-paint":"p1","first-contentful-paint":"p2"};i[r]&&!a[i[r]]&&(a[i[r]]=o,s++,window.LargestContentfulPaint||2!==s||l(n,t))},l=function(e,n){c&&y(c),(s||c)&&e.log("paint",a)},p=function(e,n){var t=e.entryType,r=e.name,o={p1:e.startTime,p2:e.duration,p3:t,p4:r,c1:e.c1,c2:e.c2,c3:e.c3,c4:e.c4,c5:e.c5,c6:e.c6};n.log("usertiming",o)},d=function(e,n,t){var r,o={startTime:"p1",identifier:"p2",name:"p3",url:"p4",element:"p5",naturalHeight:"p6",naturalWidth:"p7"},i={};for(var u in o)void 0!==e[u]&&(i[o[u]]="string"==typeof(r=e[u])||"number"==typeof r?r:"object"==typeof r&&r instanceof HTMLElement?r.tagName:void 0);n.log("elementtiming",i)},v=function(e,n){var t,r,o,i,a=n.plugin_perf_resourceTimingSampling||.01;if(!(Math.random()>=a)&&"function"==typeof window.fetch&&null!==(t=window)&&void 0!==t&&null!==(r=t.performance)&&void 0!==r&&r.getEntries&&null!==(o=window)&&void 0!==o&&null!==(i=o.performance)&&void 0!==i&&i.getEntriesByType){var c=n.plugin_perf_resourceTimingThreshhold||8e3,s=performance.getEntriesByType("navigation")[0]||window.performance.timing;if(s)if(s.loadEventStart-s.fetchStart<c)return;var f=performance.getEntries();if(f&&0!==f.length)try{var l=e.getConfig("pv_id"),p=e.getConfig("pid"),d={__topic__:"resourcetiming",__logs__:[{pid:p,name:l,resource:encodeURIComponent(u()(f.slice(0,200)))}]};if(!p||!l)return;fetch("https://aes.cn-wulanchabu.log.aliyuncs.com/logstores/aes-resourcetiming/track",{method:"POST",body:u()(d),headers:{"Content-Type":"application/json","x-log-apiversion":"0.6.0","x-log-bodyrawsize":"1234"}})}catch(e){}}},m=function(e){c=e},y=function(e){var n,t={startTime:"p3",element:"p4",url:"p5"};for(var r in t)void 0!==e[r]&&(a[t[r]]="string"==typeof(n=e[r])||"number"==typeof n?n:"object"==typeof n&&n instanceof HTMLElement?n.tagName:void 0)},h=(new Date).getTime(),g=function(){var e,n,t,r;return null!==(e=window)&&void 0!==e&&null!==(n=e.performance)&&void 0!==n&&n.now?performance.now():null!==(t=window)&&void 0!==t&&null!==(r=t.performance)&&void 0!==r&&r.timing?(new Date).getTime()-performance.timing.navigationStart:(new Date).getTime()-h};var w=function(e,n){var t=[],r=function(e){return t.concat([]).reverse().find((function(n){return n.name==="".concat(e)}))};return{mark:function(n){if(void 0===n)return console.error("Failed to execute 'mark' on 'Performance': 1 argument required, but only 0 present.");var r={name:n+"",entryType:"mark",startTime:g(),duration:0};return t.push(r),p(r,e),r},measure:function(n,t,o){if(void 0===n)return console.error("Failed to execute 'measure' on 'Performance': at least 1 argument required, but only 0 present.");var i=void 0===t?null:r(t),u=void 0===o?null:r(o);if(void 0!==t&&!i)return console.error("Failed to execute 'measure' on 'Performance': The mark '".concat(t,"' does not exist."));if(void 0!==o&&!u)return console.error("Failed to execute 'measure' on 'Performance': The mark '".concat(o,"' does not exist."));u=u||{startTime:0};var a={name:n+"",entryType:"measure",startTime:(i=i||{startTime:0}).startTime,duration:(u.startTime||g())-i.startTime};return p(a,e),a},markWithEntry:function(n){return p(o()({entryType:"mark",duration:0},n),e),n},measureWithEntry:function(n){return p(o()({entryType:"measure"},n),e),n}}},b=t(7),S=t.n(b),x=t(8),T=t.n(x),k={hasHookRequest:!1,requestStackSize:0,listeners:[],runListeners:function(){var e=this;this.listeners.forEach((function(n){return n(e.requestStackSize)}))},hook:function(){var e,n,t,r=this,o=XMLHttpRequest.prototype.send;if(window.fetch&&null!==(e=window)&&void 0!==e&&null!==(n=e.Response)&&void 0!==n&&null!==(t=n.prototype)&&void 0!==t&&t.blob){var i=window.fetch;window.fetch=function(){return r.requestStackSize++,r.runListeners(),i.apply(window,arguments).then((function(e){try{e.clone().blob().then((function(e){r.requestStackSize--,r.runListeners()}))}catch(e){}return e}),(function(e){try{r.requestStackSize--,r.runListeners()}catch(e){}throw e}))}}XMLHttpRequest.prototype.send=function(){o.apply(this,arguments),r.requestStackSize++,r.runListeners();var e=this;e.addEventListener("readystatechange",(function(){4===e.readyState&&(r.requestStackSize--,r.runListeners())}))}},addEventListener:function(e){this.hasHookRequest||(this.hook(),this.hasHookRequest=!0),this.listeners.push(e)},removeEventListener:function(e){this.listeners=this.listeners.filter((function(n){return n!==e}))}},E=function(){function e(n){var t=this;S()(this,e),this.assetsStack=0,this.requestStackSize=0,this.observer=function(){t.requestStackSize=k.requestStackSize+t.assetsStack,1!==t.end&&n(t.requestStackSize)}}return T()(e,[{key:"observe",value:function(e){var n=this;return e?(n.assetsStack++,e.addEventListener("load",(function(){n.assetsStack--,n.observer()})),void e.addEventListener("error",(function(){n.assetsStack--,n.observer()}))):(k.addEventListener(this.observer),this)}},{key:"disconnect",value:function(){this.end=1,k.removeEventListener(this.observer)}}]),e}(),_=function(){function e(n){S()(this,e),this.inputTypes=["click","keypress","wheel"],this.eventHandler=n}return T()(e,[{key:"observer",value:function(){var e=this;this.inputTypes.forEach((function(n){window.addEventListener(n,e.eventHandler,!0)}))}},{key:"disconnect",value:function(){var e=this;this.inputTypes.forEach((function(n){window.removeEventListener(n,e.eventHandler,!0)}))}}]),e}();function O(e){var n,t;if(window.PerformanceLongTaskTiming&&window.MutationObserver&&null!==(n=window)&&void 0!==n&&null!==(t=n.performance)&&void 0!==t&&t.now){var r,o,i,u,a,c,s,f,l=function(){document.hidden&&d()},p=function(){i&&clearTimeout(i),i=setTimeout((function(){s&&s.requestStackSize<1&&(d(),e({name:"aes-mcp",startTime:r-o,c1:o>0?"0":"1"}))}),100)},d=function(){i&&clearTimeout(i),i=null,[u,c,a,s,f].forEach((function(e){e&&e.disconnect(),e=null})),l&&window.removeEventListener("visibilitychange",l),l=null,0===o&&window.removeEventListener("load",v)},v=function(){(s=new E(p)).observe(),(u=new MutationObserver((function(e,n){r=performance.now(),null==e||e.forEach((function(e){var n;"childList"===e.type&&(null==e||null===(n=e.addedNodes)||void 0===n||n.forEach((function(e){(("SCRIPT"===e.tagName||"IMG"===e.tagName)&&e.src||"LINK"===e.tagName&&"stylesheet"===e.rel&&e.href)&&s&&s.observe(e)})))}))}))).observe(document.documentElement,{attributes:!0,childList:!0,subtree:!0}),window.LayoutShiftAttribution&&(c=new PerformanceObserver((function(){r=performance.now(),p()}))).observe({entryTypes:["layout-shift"]}),(a=new PerformanceObserver((function(e){e.getEntries().some((function(e){e.duration>50&&p()}))}))).observe({entryTypes:["longtask"]}),(f=new _((function(){d()}))).observer(),window.addEventListener("visibilitychange",l),p()};return"complete"!==document.readyState?(o=0,window.addEventListener("load",v)):(o=performance.now(),v()),{abort:d}}}var P=function(e){"complete"===document.readyState?setTimeout(e):window.addEventListener("load",(function(){return setTimeout(e)}))},j=function(){var e,n,t;if((null===(e=window)||void 0===e||null===(n=e.performance)||void 0===n||null===(t=n.timing)||void 0===t?void 0:t.navigationStart)>0){var r={};for(var o in performance.timing)"number"==typeof performance.timing[o]&&performance.timing[o]>0&&(r[o]=Math.max(performance.timing[o]-performance.timing.navigationStart,0));return r}},L=function(e,n){if(window.PerformanceObserver){var t,r=[];n.plugin_perf_enableUserTimingObserve&&(window.PerformanceMark&&r.push("mark"),window.PerformanceMeasure&&r.push("measure")),window.PerformancePaintTiming&&r.push("paint"),window.PerformanceElementTiming&&r.push("element"),window.LargestContentfulPaint&&(r.push("largest-contentful-paint"),t=function(){l(e,n)},document.addEventListener("visibilitychange",(function e(){document.hidden&&(document.removeEventListener("visibilitychange",e,!0),t())}),!0));try{!function(){for(var t={},o=0;o<r.length;o++){var i=r[o],u=new PerformanceObserver((function(r){r.getEntries().forEach((function(r){switch(r.entryType){case"paint":f(r,e,n);break;case"mark":case"measure":p(r,e);break;case"element":t[r.identifier]||(t[r.identifier]=1,d(r,e));break;case"largest-contentful-paint":m(r)}}))}));try{u.observe({type:i,buffered:!0})}catch(e){u.observe({entryTypes:r});break}}}()}catch(e){}}};function M(e,n){for(var t in n)e[t]=n[t];return e}n.default=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n=M(M({},e.getConfig()),n);var t=w(e,n),r=t.mark,o=t.measure,i=t.markWithEntry,u=t.measureWithEntry;return P((function(){var t=j();t&&t.responseStart&&t.responseEnd&&t.responseEnd>=t.responseStart&&e.log("perf",t),n.plugin_perf_enableResourceTiming&&setTimeout((function(){v(e,n)}),1e3)})),L(e,n),{mark:r,measure:o,markWithEntry:i,measureWithEntry:u,markOnMCP:function(e){return O((function(n){i(n),e&&e({startTime:n.startTime})}))}}}}]).default}));!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("@ali/aes-tracker-plugin-eventTiming/index",[],n):"object"==typeof exports?exports.AESPluginEventTiming=n():e.AESPluginEventTiming=n()}(window,(function(){return function(e){var n={};function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(n){return e[n]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}([function(e,n,t){"use strict";t.r(n);var i=function(e){for(var n=[],t=window,i=document,r=0,o=e.length;r<o;r++){var u=e[r];if(u===t||u===i)break;if(u.id){n.push("#".concat(u.id));break}u.className&&"string"==typeof u.className?n.push("."+u.className.split(/\s+/).filter((function(e){return!!e})).join(".")):n.push(u.nodeName)}return n.reverse().join(" ")},r=function(e){if("[object Array]"===Object.prototype.toString.apply(e))return i(e);for(var n=[],t=e;t;)n.push(t),t=t.parentNode;return i(n)},o=void 0!==document.hidden?{hidden:"hidden",visibilityChange:"visibilitychange"}:void 0!==document.webkitHidden?{hidden:"webkitHidden",visibilityChange:"webkitvisibilitychange"}:void 0!==document.msHidden?{hidden:"msHidden",visibilityChange:"msvisibilitychange"}:void 0,u=!!o;n.default=function(e,n){var t,i;if(window.PerformanceEventTiming){var c,d,a,s,f=function(n,t){var i,o;i=function(){e.log("eventTiming",{p1:n.startTime,p2:n.duration,p3:n.target&&r(n.target),p4:n.name,p5:n.processingStart,p6:n.processingEnd,p7:t?"1":"0"})},"function"==typeof requestIdleCallback?requestIdleCallback(i,{timeout:o||1e3}):setTimeout(i,0)},l=new PerformanceObserver((function(e){var n=e.getEntries().filter((function(e){return void 0!==e.interactionId&&e.processingStart&&e.processingEnd&&e.processingEnd-e.processingStart>1})),t=n.filter((function(e){return 0!==e.interactionId})).reduce((function(e,n){var t=n.interactionId;return e[t]||(e[t]=[]),e[t].push(n),e}),{});for(var i in t)f(t[i][t[i].length-1]);n.filter((function(e){return 0===e.interactionId})).forEach((function(e){f(e)}))}));try{l.observe({type:"event",durationThreshold:100})}catch(e){}null!==(t=window.PerformanceObserver)&&void 0!==t&&null!==(i=t.supportedEntryTypes)&&void 0!==i&&i.includes("first-input")&&(c=new PerformanceObserver((function(e,n){f(e.getEntries()[0],!0),n.disconnect(),c=null}))).observe({type:"first-input",buffered:!0}),d=function(e){e?setTimeout((function(){try{l.observe({type:"event",durationThreshold:100})}catch(e){}}),100):(c&&c.disconnect(),l&&l.disconnect())},u&&document.addEventListener(o.visibilityChange,s=function(e){a&&document.removeEventListener(o.visibilityChange,s),d(!document[o.hidden])})}}}]).default}));!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("@ali/aes-tracker-plugin-blank/index",[],n):"object"==typeof exports?exports.AESPluginBlank=n():t.AESPluginBlank=n()}(window,(function(){return function(t){var n={};function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)e.d(r,o,function(n){return t[n]}.bind(null,o));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=6)}([function(t,n,e){t.exports=e(7)},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n,e){t.exports=!e(5)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(t,n){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},function(t,n){var e=t.exports={version:"2.6.12"};"number"==typeof __e&&(__e=e)},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,e){"use strict";e.r(n);var r=e(0),o=e.n(r);function u(t,n){for(var e in n)t[e]=n[e];return t}var i=function(t,n,e){var r=t.plugin_blank_target,u=t.plugin_blank_tester,i=t.plugin_blank_when,c=t.plugin_blank_timeout;if(r){n=n||o()();var f,a=[],l=function(){a.forEach((function(t){return t()})),a=[]},p=function(t){try{!f&&function(t,n){try{var e=document.querySelector(t);return!("function"==typeof n?n(e):"HAS_CONTENT"==n?e&&e.textContent:!!e)}catch(t){}}(r,u)&&(e.log("blank",{p1:c,p2:r,p3:o()()-n,p4:"complete"===document.readyState,p5:t}),f=!0),l()}catch(t){}};return i.forEach((function(t){var e=function(){p("function"==typeof t?"custom":t)};if("timeout"===t){var r=setTimeout(e,c-(o()()-n));a.push((function(){r&&clearTimeout(r)}))}else if("leave"===t){var u;document.addEventListener("visibilitychange",u=function(){"complete"===document.readyState&&document.hidden&&e()}),a.push((function(){document.removeEventListener("visibilitychange",u)}))}else if("error"===t){var i;window.addEventListener("error",i=function(){"complete"===document.readyState&&e()}),a.push((function(){window.removeEventListener("error",i)}))}else if("load"===t)"complete"===document.readyState?setTimeout(e,0):(window.addEventListener("load",e),a.push((function(){window.removeEventListener("load",e)})));else if("function"==typeof t){var f=t(e);"function"==typeof f&&a.push(f)}})),l}};n.default=function(t){var n,e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=u(u({plugin_blank_tester:"EXISTS",plugin_blank_when:["timeout","leave"],plugin_blank_timeout:5e3},t.getConfig()),r);return o.plugin_blank_autoTest&&i(o,null===(n=window.performance)||void 0===n||null===(e=n.timing)||void 0===e?void 0:e.navigationStart,t),{test:function(n){return i(u(u({},o),n),null,t)}}}},function(t,n,e){e(8),t.exports=e(4).Date.now},function(t,n,e){var r=e(9);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,n,e){var r=e(3),o=e(4),u=e(10),i=e(12),c=e(19),f=function(t,n,e){var a,l,p,s=t&f.F,d=t&f.G,v=t&f.S,y=t&f.P,m=t&f.B,b=t&f.W,g=d?o:o[n]||(o[n]={}),w=g.prototype,h=d?r:v?r[n]:(r[n]||{}).prototype;for(a in d&&(e=n),e)(l=!s&&h&&void 0!==h[a])&&c(g,a)||(p=l?h[a]:e[a],g[a]=d&&"function"!=typeof h[a]?e[a]:m&&l?u(p,r):b&&h[a]==p?function(t){var n=function(n,e,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,e)}return new t(n,e,r)}return t.apply(this,arguments)};return n.prototype=t.prototype,n}(p):y&&"function"==typeof p?u(Function.call,p):p,y&&((g.virtual||(g.virtual={}))[a]=p,t&f.R&&w&&!w[a]&&i(w,a,p)))};f.F=1,f.G=2,f.S=4,f.P=8,f.B=16,f.W=32,f.U=64,f.R=128,t.exports=f},function(t,n,e){var r=e(11);t.exports=function(t,n,e){if(r(t),void 0===n)return t;switch(e){case 1:return function(e){return t.call(n,e)};case 2:return function(e,r){return t.call(n,e,r)};case 3:return function(e,r,o){return t.call(n,e,r,o)}}return function(){return t.apply(n,arguments)}}},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n,e){var r=e(13),o=e(18);t.exports=e(2)?function(t,n,e){return r.f(t,n,o(1,e))}:function(t,n,e){return t[n]=e,t}},function(t,n,e){var r=e(14),o=e(15),u=e(17),i=Object.defineProperty;n.f=e(2)?Object.defineProperty:function(t,n,e){if(r(t),n=u(n,!0),r(e),o)try{return i(t,n,e)}catch(t){}if("get"in e||"set"in e)throw TypeError("Accessors not supported!");return"value"in e&&(t[n]=e.value),t}},function(t,n,e){var r=e(1);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,n,e){t.exports=!e(2)&&!e(5)((function(){return 7!=Object.defineProperty(e(16)("div"),"a",{get:function(){return 7}}).a}))},function(t,n,e){var r=e(1),o=e(3).document,u=r(o)&&r(o.createElement);t.exports=function(t){return u?o.createElement(t):{}}},function(t,n,e){var r=e(1);t.exports=function(t,n){if(!r(t))return t;var e,o;if(n&&"function"==typeof(e=t.toString)&&!r(o=e.call(t)))return o;if("function"==typeof(e=t.valueOf)&&!r(o=e.call(t)))return o;if(!n&&"function"==typeof(e=t.toString)&&!r(o=e.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var e={}.hasOwnProperty;t.exports=function(t,n){return e.call(t,n)}}]).default}));!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("@ali/aes-tracker-plugin-autolog/index",[],e):"object"==typeof exports?exports.AESPluginAutolog=e():t.AESPluginAutolog=e()}(window,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";r.r(e);var n=function(t,e){return s({click:"all",exposure:"manual",autoLoad:!0,autologProps:["data-autolog"],containerProps:["data-autolog-container"]},s((t.getConfig?o(t.getConfig("plugin_autolog")):{})||{},e||{}))},o=function(t){if(!t)return t;var e={};for(var r in t){void 0!==t[r]&&(e[r]=t[r])}return e},i=function(t,e){var r=[];if(e&&e.length>0&&(r=e.slice()),t&&t.length>0)for(var n=0;n<t.length;n++)r.push(t[n]);return r};function a(t,e){var r=t||{};for(var n in e)r[n]=e[n];return r}function s(t,e){var r=a({},t);return a(r,e)}function u(t){if("object"!=typeof t)return[];var e=[];for(var r in t)e.push(r);return e}function c(t,e){for(var r={},n={},o=0;o<e.length;o++){var i=e[o];i&&(n[i]=!0)}for(var a in t)n[a]||(r[a]=t[a]);return r}var l=/(^[\s　*]+)|([\s　：:~-]+$)|([(（]\d+[)）])/gm,f=function(t){return t.innerText||t.title||t.defaultValue},d=function(t){return t?/^[+-]?[\d,]+(\.\d+)?$/.test(t)?"[NUMBER]":t.substr(0,30):""};function h(t){for(var e,r=(e=t,"[object Array]"===Object.prototype.toString.call(e)?t:[t]),n=r.length,o=0;o<n;o++){var i=r[o];if(f(i)){var a=f(p(i));if(!a)continue;return d(a.replace(l,""))}}return""}function p(t){if(!!t.querySelector(".badge")){var e=t.cloneNode(!0);return(Array.prototype.slice.apply(e.querySelectorAll(".badge"))||[]).forEach((function(t){var e;return null==(e=t.parentElement)?void 0:e.removeChild(t)})),e}return t}var g=["button","checkbox","link","menuitem","radio","tab","combobox","search"];function v(t){var e=t.getAttribute("role");return e&&g.indexOf(e)>-1?e:""}function _(t){for(var e=[],r=[],n=[],o=t,i=!1,a=function(){var t=o.tagName,a="string"==typeof t?t.toLocaleLowerCase():o instanceof HTMLFormElement?"form":"unknown";if(n.push(a),e.push(o),!i){var s=o.id;if(s&&o!==document.body&&o!==document.documentElement&&(r.push('/*[@id="'+s+'"]'),i=!0),o.parentElement){var u=Array.prototype.slice.apply(o.parentElement.children).filter((function(t){return t.tagName.toLocaleLowerCase()===a}));u.length>1&&(a=a+"["+(u.indexOf(o)+1)+"]")}i||r.push(a)}o=o.parentElement};o;)a();return{reversedXPathArray:r,reversedDOMArray:e,xpath:m(r),reversedTagNameArray:n}}function m(t){return"/"+[].concat(t).reverse().join("/")}var E,y,w,b,A,O=function(t,e,r,n){T(t,e.name,!0);var i=s(e,{config:o(r)});t.registry[n?"unshift":"push"](i),x(t)},T=function(t,e,r){e&&(t.registry=!0===e?[]:t.registry.filter((function(t){return t.name!==e})),!r&&x(t))},x=function(t){var e=[],r=[];t.registry.forEach((function(t){if(t.prioritizedRules){var n=e.concat(t.prioritizedRules);e=n.map((function(e){return s(e,{plugin:t})}))}if(t.rules){var o=r.concat(t.rules);r=o.map((function(e){return s(e,{plugin:t})}))}})),t.ruleList=e.concat(r)},M=function(t,e){return s(e?function(t,e){var r=e.reversedDOMArray,n=e.reversedXPathArray,o=e.reversedTagNameArray,i=r.indexOf(t);if(-1!==i){var a=i+1,s=n.slice(0,a);return{reversedDOMArray:r.slice(0,a),reversedTagNameArray:o.slice(0,a),reversedXPathArray:s,xpath:m(s)}}return _(t)}(t,e):_(t),{tagName:t.tagName.toLowerCase()})},P=function(t,e,r,n){var i=function t(e,r){for(var n=r.source,i=r.logType,a=r.isRestarted,u=r.isByManual,l=e.ruleList.length,f={feature:"",text:"",xpath:"",container:"",target:n},d=s({source:n,logType:i,isByManual:u},{info:M(n),utils:{getFeature:v,getText:h}}),p=0;p<l;p++){var g=e.ruleList[p];try{var _=g.selector,m=g.action,E=g.plugin;d.config=s(E.defaultConfig,E.config);var y=_(d,e);if(y){d.target=y,f.target=y,y!==n&&y&&(d.info=M(y));var w="function"==typeof m?m(d,e):m;if(w){var b=w.__break,A=c(w,["__continue","__restart","__break"]);if(b){f.feature="";break}if(w.__restart){if(!a)return t(e,{source:y,logType:i,isRestarted:!0,isByManual:u});console.error("[aes-autolog] 已经重新执行过规则。请检查规则逻辑"),console.error(g)}if(f.feature=A.feature||f.feature||v(y),f.text=A.text||f.text||h(y)||A.placeholder||"",f.xpath=A.xpath||f.xpath||d.info.xpath,f.container=A.container||f.container||"",f.extra=A.extra?s(f.extra,o(A.extra)):f.extra,w.__continue)continue}else f.feature=f.feature||v(y),f.text=f.text||h(y),f.xpath=f.xpath||d.info.xpath;break}}catch(t){console.error("[aes-autolog] 规则执行出错",g),console.error(t)}}return f}(t,{source:e,logType:r,isByManual:n}),a=i.target,u=i.extra,l=c(i,["target","extra"]);if(!!l.feature)return s(o(u),s(o(l),{className:a.getAttribute("class")||"",selector:"",logtype:r}))},L=function(){return(new Date).valueOf()},S=window&&"ontouchstart"in window,N=function(t){for(var e in t.registeredListeners){var r=e,n=t.registeredListeners[r];n&&t.target.removeEventListener(r,n)}};!function(t){t.AUTOEXP_KEY="autolog-exp-hash"}(E||(E={})),function(t){t.EXP_CONFIG_CHANGE="EXP_CONFIG_CHANGE",t.DOM_CHANGE="DOM_CHANGE",t.DOM_REMOVE="DOM_REMOVE",t.EXP_WATCH_CHANGE="EXP_WATCH_CHANGE",t.DOM_DURATION_END="DOM_DURATION_END"}(y||(y={})),function(t){t[t.INIT=0]="INIT",t[t.IN_VIEW=1]="IN_VIEW",t[t.OUT_VIEW=2]="OUT_VIEW"}(w||(w={})),function(t){t[t.INIT=0]="INIT",t[t.REPORTED=1]="REPORTED"}(b||(b={})),function(t){t[t.WAITTING=0]="WAITTING",t[t.LISTENING=1]="LISTENING",t[t.REPORTED=2]="REPORTED"}(A||(A={}));var C=function(t){return"number"==typeof t};var I=function(){var t,e;return!(null==(t=window.__AES_AUTOLOG_EXP__)||null==(e=t.globalConfig)||!e.debug)},D=function(){var t;return!(!window.IntersectionObserver||null!=(t=window.__AES_AUTOLOG_EXP__)&&t.testOldIO)};function R(){var t=(new Date).getTime();return"xxxxxxxxxxxx4x".replace(/[xy]/g,(function(e){var r=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?r:3&r|8).toString(16)}))}function U(t){return t&&t.getAttribute?t.getAttribute("autolog-exp-hash"):null}var G=function(t){var e={};return t&&("function"==typeof t.getBoundingClientRect&&(e=t.getBoundingClientRect()),C(e.x)||C(e.left)&&(e.x=e.left),C(e.y)||C(e.top)&&(e.y=e.top),C(e.width)||(e.width=t.offsetWidth),C(e.height)||(e.height=t.offsetHeight),e.size=e.width*e.height),e},k=function(t,e){return e.x>=t.pLeftTop[0]&&e.x<=t.pRightBottom[0]&&e.y>=t.pLeftTop[1]&&e.y<=t.pRightBottom[1]};function W(t){var e=[];if(t&&"function"==typeof document.querySelector){var r=document.querySelector(t);if(r){var n=G(r)||{};if(C(n.x)&&C(n.y)&&C(n.width)&&C(n.height)){var o=n;e.push({pLeftTop:[o.x,o.y],pRightTop:[o.x+o.width,o.y],pLeftBottom:[o.x,o.y+o.height],pRightBottom:[o.x+o.width,o.y+o.height]})}}}var i=document.documentElement,a=document.body,s=i.clientWidth||a.offsetWidth||0,u=i.clientHeight||a.offsetHeight||0;return e.push({pLeftTop:[0,0],pRightTop:[s,0],pLeftBottom:[0,u],pRightBottom:[s,u]}),e}function H(t){var e,r,n,o,i,a,s,u,c,l,f=t.rootPositions,d=t.elemPosition;if(f&&f.length)for(var h=0;h<f.length;h++){var p=f[h];if(!p)return!1;if((n=void 0,o=void 0,i=void 0,a=void 0,s=void 0,u=void 0,c=void 0,l=void 0,a=0,s=k(e=p,r=d),u=k(e,{x:r.x+r.width,y:r.y}),c=k(e,{x:r.x,y:r.y+r.height}),l=k(e,{x:r.x+r.width,y:r.y+r.height}),n=0,s&&l&&(n=r.size/r.size),(a=n)>0?a:(o=0,i=0,s&&u&&!c&&!l?(o=r.width,i=e.pLeftBottom[1]-r.y):!s&&u&&!c&&l?(o=r.width+r.x,i=r.y):!s&&!u&&c&&l?(o=r.width,i=r.height+r.y):s&&!u&&c&&!l&&(o=e.pRightTop[0]-r.x,i=r.y),(a=r.size>0?Math.abs(o*i)/r.size:0)>0?a:a=function(){var t=0,n=0;return!s||u||c||l?s||!u||c||l?s||u||!c||l?s||u||c||!l||(t=e.pLeftTop[0]-r.x,n=e.pLeftTop[1]-r.y):(t=e.pRightTop[0]-r.x,n=e.pRightTop[1]-r.y):(t=e.pLeftBottom[0]-r.x,n=e.pLeftBottom[1]-r.y):(t=e.pRightBottom[0]-r.x,n=e.pRightBottom[1]-r.y),r.size>0?Math.abs(t*n)/r.size:0}()))<t.targetRate)return!1}return!0}function X(){var t,e;if(null!=(t=window.__AES_AUTOLOG_EXP__)&&null!=(e=t.globalConfig)&&e.debug)for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o]}function B(t){console.error("[tracker-plugin-autolog-exposure]",t)}var V=function(t){var e,r=this;this.isThrottleWatch=null==(e=t.isThrottleWatch)||e,this._observer=window.__AES_AUTOLOG_EXP__.mutationObserver,this._removeElementHashs=[],this._removing=!1,this._looptimes=0,this._oldWatching=!1,this.windowStatus="focus",this._eventMap={},this._throttleHandlerDomChange=function(t,e,r){var n,o,i,a,s=0;r||(r={});var u=function(){s=!1===r.leading?0:+new Date,n=null,a=t.apply(o,i),n||(o=i=null)},c=function(){var c=+new Date;s||!1!==r.leading||(s=c);var l=e-(c-s);return o=this,i=arguments,l<=0||l>e?(n&&(clearTimeout(n),n=null),s=c,a=t.apply(o,i),n||(o=i=null)):n||!1===r.trailing||(n=setTimeout(u,l)),a};return c.cancel=function(){clearTimeout(n),s=0,n=o=i=null},c}((function(t){r.domChangeHandler(t)}),200)};V.prototype.initObserver=function(t,e){var r=this,n=["IFRAME","BODY","OBJECT","SCRIPT","NOSCRIPT","LINK","STYLE"],o=["class","style"],a=function(t){return"characterData"===t.type||"attributes"===t.type&&t.attributeName&&o.indexOf(t.attributeName)>-1?[t.target]:"childList"!==t.type?[]:void 0},s=function(t,r){var o,i,a=(null==(o=window.__AES_AUTOLOG_EXP__)||null==(i=o.globalConfig)?void 0:i.ignoreAttrs)||[];if(t&&t.length>0){var s=t.filter((function(t){return!(n.indexOf(t.nodeName)>-1)&&!a.some((function(e){return function(t,e){if(e(t))return!0;for(var r=t.parentNode;r;){if(e(r))return!0;r=r.parentNode}return!1}(t,(function(t){var r=t;return!!r&&!!r.getAttribute&&!!r.getAttribute(e)}))}))}));s.length&&e(s,r)}},u=function(t){for(var e=0;e<t.length;e++){var o=t[e];if(o&&(n.indexOf(o.nodeName)<0&&1===o.nodeType)){var i=U(o);i&&r._removeElementHashs.push(i)}}r._removing||(r._removing=!0,setTimeout((function(){r._removeElementHashs.length&&window.__AES_AUTOLOG_EXP__.pubSub.publish(y.DOM_REMOVE,r._removeElementHashs),r._removeElementHashs=[],r._removing=!1}),200))};this._observer||(this._observer=new t((function(t){if(t&&t.length>0)for(var e=0;e<t.length;e++){var r=t[e];if(r){var n=i(r.addedNodes||[]);n=i(a(r),n),s(n,r),r.removedNodes.length&&u(i(r.removedNodes))}}})),window.__AES_AUTOLOG_EXP__.mutationObserver=this._observer);this._observer.observe(document.body,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),X("init MutationObserver success!")},V.prototype.domChangeHandler=function(t){window.__AES_AUTOLOG_EXP__.pubSub.publish(y.DOM_CHANGE,t)},V.prototype.onFocusHandler=function(){this.windowStatus="focus",this._oldWatching||this.oldWatchDOMChange()},V.prototype.onBlurHandler=function(){this.windowStatus="blur"},V.prototype.onVisibilityChange=function(){"visible"===document.visibilityState?this.onFocusHandler():"hidden"===document.visibilityState&&this.onBlurHandler()},V.prototype.addEvent=function(t,e,r,n){this._eventMap[e]=r,t.addEventListener(e,r,n)},V.prototype.removeEvent=function(t,e,r){var n=this._eventMap[e];n&&(t.removeEventListener(e,n,r),delete this._eventMap[e])},V.prototype.addAllListener=function(){this.oldWatchDOMChange(),window.WindVane&&(this.addEvent(document,"WV.Event.APP.Active",this.onFocusHandler.bind(this),!1),this.addEvent(document,"WV.Event.APP.Background",this.onBlurHandler.bind(this),!1)),"hidden"in document?this.addEvent(window,"visibilitychange",this.onVisibilityChange.bind(this)):(this.addEvent(window,"focus",this.onFocusHandler.bind(this)),this.addEvent(window,"blur",this.onBlurHandler.bind(this)))},V.prototype.removeAllListener=function(){window.WindVane&&(this.removeEvent(document,"WV.Event.APP.Active",!1),this.removeEvent(document,"WV.Event.APP.Background",!1)),"hidden"in document?this.removeEvent(window,"visibilitychange"):(this.removeEvent(window,"focus"),this.removeEvent(window,"blur"))},V.prototype.scrollHandler=function(){this._throttleHandlerDomChange({type:"polling"})},V.prototype.oldWatchDOMChange=function(){var t=this;this._loopTimer=setTimeout((function(){if(clearTimeout(t._loopTimer),"blur"!==t.windowStatus){var e,r;t._looptimes++,t._oldWatching=!0,t.domChangeHandler({type:"polling"});var n=null==(e=window.__AES_AUTOLOG_EXP__)?void 0:e.dispatcher;null!=n&&null!=(r=n.listenerMap)&&r.size&&t.oldWatchDOMChange()}else t._oldWatching=!1}),1e3)},V.prototype.start=function(){var t,e=window.MutationObserver,r=this;(function(){var t;return!(!window.MutationObserver||null!=(t=window.__AES_AUTOLOG_EXP__)&&t.testOldMO)})()?this.initObserver(e,(function(){r._throttleHandlerDomChange({type:"mob"})})):null!=(t=window.__AES_AUTOLOG_EXP__.globalConfig)&&t.disabledPolling?X("当前浏览器版本不支持曝光监听"):(this.domChangeHandler({type:"init"}),this.addAllListener());D()||(this.addEvent(window,"touchmove",this.scrollHandler.bind(this),{passive:!0}),this.addEvent(window,"scroll",this.scrollHandler.bind(this),{passive:!0}),this.addEvent(window,"resize",this.scrollHandler.bind(this),{passive:!0}))},V.prototype.stop=function(){this._loopTimer&&(clearTimeout(this._loopTimer),this._loopTimer=null),this._observer?(this._observer.takeRecords(),this._observer.disconnect()):this.removeAllListener(),D()||(this.removeEvent(window,"touchmove",{passive:!0}),this.removeEvent(window,"scroll",{passive:!0}),this.removeEvent(window,"resize",{passive:!0}))};var F=function(){this._data={},this.size=0};F.prototype.set=function(t,e){this._data&&(this._data[t]=e,this.size++)},F.prototype.get=function(t){if(this._data)return this._data[t]},F.prototype.delete=function(t){this._data&&(delete this._data[t],this.size--)},F.prototype.has=function(t){return!!this._data&&void 0!==this._data[t]},F.prototype.forEach=function(t){var e=this._data||{};for(var r in e){var n=e&&e[r];n&&t(n,r)}},F.prototype.clear=function(){this._data={}};var z={every:!1,duration:200,threshold:.5},j=function(t){this.config=s(z,t),this.status=A.WAITTING,this.token=function(t){var e,r,n,o="";t.selectorFunc?o=t.selectorFunc.name||"selectorFunc":t.selector&&(o=t.selector,t.rootSelector&&(o+=t.rootSelector+"_"));var i=(null==(e=window.__AES_AUTOLOG_EXP__)||null==(r=e.cacheSelectorNameMap)?void 0:r[o])||0;return n=o+"_exp_"+(i+1),window.__AES_AUTOLOG_EXP__.cacheSelectorNameMap[o]=i+1,n}(t),this.observerNameMap=new F};j.prototype.needReport=function(t){return!(!this.config.every||!I())||!((e=t)&&e.getAttribute("autolog-exp-reported")===""+b.REPORTED);var e},j.prototype.onExposure=function(t){var e=t.element;"function"==typeof this.config.onExposure&&this.config.onExposure({element:e,config:this.config}),this.changeStatus(A.REPORTED)},j.prototype.getElements=function(){var t=this.config;if(t.selectorFunc)return i(t.selectorFunc());if(t.selector){var e=(t.rootSelector?document.querySelector(t.rootSelector):document)||document;return i(e.querySelectorAll(t.selector))}return[]},j.prototype.changeStatus=function(t){this.status=t};var q=function(t){this.dom=t.element,this.id=t.id,this.listenerMap=new F,this.everyListenerMap=new F,this.observerMap=new F,this.durationList=[],this.durationTaskMap=new F,this.status=w.INIT,this.reportStatus=b.INIT,this.dom.setAttribute("autolog-exp-hash",this.id)};q.prototype.addListener=function(t){this.listenerMap.set(t.token,t),t.config.every&&I()&&this.everyListenerMap.set(t.token,t)},q.prototype.needReport=function(){return!(!this.dom||0===this.listenerMap.size)&&(this.listenerMap.size>0||this.everyListenerMap.size>0)},q.prototype.watch=function(t){D()?this.intersectionWatch():this.watchByPolling(t)},q.prototype.watchByPolling=function(t){this.checkIsInView(t)&&this.exposureStart({isPolling:!0})},q.prototype.isInWatch=function(t){return this.observerMap.has(t)},q.prototype.intersectionWatch=function(){var t=this,e=window.__AES_AUTOLOG_EXP__.dispatcher;this.listenerMap.size&&this.listenerMap.forEach((function(r){var n=e.getIObserver(r.config),o=n.name,i=n.observer;t.isInWatch(o)||(i.observe(t.dom),t.observerMap.set(o,r.token)),r.observerNameMap.set(o,o)}))},q.prototype.isInView=function(t){var e=t.rootPositions,r=t.rate,n=t.elemPosition;return this.status===w.IN_VIEW&&H({rootPositions:e,elemPosition:n,targetRate:r||.5})},q.prototype.IOhandleDurationTask=function(t){if(t)for(var e=this.durationList,r=0;r<e.length;r++){var n=e[r];if(n&&n.flag===t){if(!(this.status===w.IN_VIEW)){this.exposureLeave();break}this.handleReport(n.listener)}}},q.prototype.checkIsInView=function(t){var e=G(this.dom),r=[];this.listenerMap.forEach((function(t){return r.push(t)}));for(var n=t,o=0;o<r.length;o++){var i=r[o];if(i){var a=i.config,s=null==a?void 0:a.rootSelector;if(s&&(n=W(s)),H({rootPositions:n,elemPosition:e,targetRate:a.threshold||.5}))return!0}}return!1},q.prototype.oldhandleDurationTask=function(t){if(t)for(var e=W(),r=G(this.dom),n=this.durationList,o=0;o<n.length;o++){var i=n[o];if(i&&i.flag===t){var a=e,s=i.listener.config,u=null==s?void 0:s.rootSelector;if(u&&(a=W(u)),!this.isInView({rootPositions:a,rate:null==s?void 0:s.threshold,elemPosition:r})){this.exposureLeave();break}this.handleReport(i.listener)}}},q.prototype.handleDurationTask=function(t){this.status!==w.OUT_VIEW&&(this.dom&&!function(t){for(var e;t&&"HTML"!==t.tagName&&"none"!==(e=t.style.display);)t=t.parentNode;return"none"===e}(this.dom)?(D()?this.IOhandleDurationTask(t):this.oldhandleDurationTask(t),this.durationList=this.durationList.filter((function(e){return e.flag!==t}))):this.exposureLeave())},q.prototype.handleReport=function(t){var e;this.reportStatus!==b.REPORTED&&(this.reportStatus=b.REPORTED,(e=this.dom)&&e.setAttribute("autolog-exp-reported",""+b.REPORTED)),t.onExposure({element:this.dom}),t.config.every&&I()||this.listenerMap.delete(t.token)},q.prototype.exposureStart=function(t){var e=this,r=t.observerName,n=t.isPolling;if((n||r)&&this.needReport()){var o=+new Date;this.status=w.IN_VIEW,this.listenerMap.forEach((function(t){var i=t.config.duration;if(i){if(n||r&&t.observerNameMap.has(r)){var a=o+"_"+r+"_"+i;if(!e.durationTaskMap.has(a)){var s=setTimeout((function(){e.handleDurationTask(a)}),i);e.durationTaskMap.set(a,{flag:a,timer:s})}e.durationList.push({listener:t,flag:a})}}else e.handleReport(t)}))}},q.prototype.exposureLeave=function(){this.status=w.OUT_VIEW,this.durationTaskMap.forEach((function(t){t&&clearTimeout(t)})),this.durationList=[],this.durationTaskMap.clear()};var Y=window.IntersectionObserver,K=function(){this.watchElemetMap=new F,this.listenerMap=new F,this.observerMap=new F,this.isThrottling=!1,this._watchTimes=0,this._domChangeTimes=0,this._configChangeTimes=0,Y&&this.observerMap.set("io_base",this.createIObserver({},"io_base")),this.start()};function Q(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");return t}K.prototype.updateElementSub=function(t){var e=this,r=t.type;if("PAUSED"!==this.status){var n=0;this.listenerMap.forEach((function(t){for(var r=t.getElements(),o=0;o<r.length;o++){var i=r[o];if(i){var a=void 0;if(t.needReport(i)){a=U(i);var s=e.watchElemetMap.get(a);if(s)s.listenerMap.has(t.token)||(s.addListener(t),n++);else{a=a||R();var u=new q({id:a,element:i});n++,u.addListener(t),e.watchElemetMap.set(a,u)}}}}})),"polling"!==r&&0===n||window.__AES_AUTOLOG_EXP__.pubSub.publish(y.EXP_WATCH_CHANGE)}},K.prototype.watchDom=function(){var t,e,r,n,o=this,i=this;t=function(){i.domWatcher||(i.domWatcher=new V({isThrottleWatch:!0}),o.listenerMap.size&&i.domWatcher.start())},r=0,n=function(){0===r&&t(),r++},"complete"===document.readyState&&n(),document.addEventListener&&(e=function(){document.removeEventListener("DOMContentLoaded",e,!1),n()},document.addEventListener("DOMContentLoaded",e,!1),window.addEventListener("load",n,!1))},K.prototype.start=function(){this.watchDom(),this.status="WATCHING",window.__AES_AUTOLOG_EXP__.pubSub.subscribe(y.EXP_CONFIG_CHANGE,this.handleConfigChange.bind(this)),window.__AES_AUTOLOG_EXP__.pubSub.subscribe(y.EXP_WATCH_CHANGE,this.onWatchMapChange.bind(this)),window.__AES_AUTOLOG_EXP__.pubSub.subscribe(y.DOM_CHANGE,this.handleDOMChange.bind(this)),window.__AES_AUTOLOG_EXP__.pubSub.subscribe(y.DOM_REMOVE,this.handleDOMRemove.bind(this))},K.prototype.handleDOMRemove=function(t,e){var r=this;try{e.forEach((function(t){var e=r.watchElemetMap.get(t);e&&r.clearWatchElement(e,t)}))}catch(t){B(t)}},K.prototype.handleDOMChange=function(t,e){X("domChange",{info:e}),this.updateElementSub(e),this._domChangeTimes++},K.prototype.handleConfigChange=function(){this.reset(),this.updateElementSub({type:"config"}),this._configChangeTimes++},K.prototype.clearWatchElement=function(t,e){var r=this;t&&(t.dom&&t.observerMap.forEach((function(e){var n=r.observerMap.get(e);n&&n.unobserve(t.dom)})),this.watchElemetMap.delete(e))},K.prototype.cleanupWatchElement=function(t,e){return!t.needReport()&&(this.clearWatchElement(t,e),!0)},K.prototype.onWatchMapChange=function(){var t=this;if(!this.isThrottling){this.isThrottling=!0;var e=setTimeout((function(){clearTimeout(e);var r=W();t.watchElemetMap.forEach((function(e,n){t.cleanupWatchElement(e,n)||(t._watchTimes++,e.watch(r))})),t.isThrottling=!1}),50)}},K.prototype.handleDomExposureChange=function(t,e){var r=t.target.getAttribute("autolog-exp-hash");if(r){var n=this.watchElemetMap.get(r);if(n&&t.target===n.dom)(void 0===t.isIntersecting?t.intersectionRatio>=.5:t.isIntersecting)?n.exposureStart({observerName:e}):n.status===w.IN_VIEW&&n.exposureLeave()}},K.prototype.createIObserver=function(t,e){var r=this;return new Y((function(t){t.forEach((function(t){r.handleDomExposureChange(t,e)}))}),s({root:null,rootMargin:"0px",threshold:.5},t))},K.prototype.clearWatch=function(){this.watchElemetMap.clear(),Y&&this.clearIObserver()},K.prototype.clearIObserver=function(){this.observerMap.forEach((function(t){t.disconnect()}))},K.prototype.getIObserver=function(t){var e,r=.5===t.threshold?"io_base":"io_v_"+t.threshold;if("io_base"!==r){var n=this.observerMap.get(r);if(n)e=n;else{var o=this.createIObserver({threshold:t.threshold},r);this.observerMap.set(r,o),e=o}}else e=this.observerMap.get(r);return{name:r,observer:e}},K.prototype.reset=function(){this.domWatcher&&this.domWatcher.stop(),this.clearIObserver(),this.watchElemetMap.forEach((function(t){t.dom&&(t.dom.removeAttribute("autolog-exp-hash"),t.dom.removeAttribute("autolog-exp-reported"))})),this.watchElemetMap.clear(),this.domWatcher&&this.domWatcher.start()},K.prototype.pauseAll=function(){"PAUSED"!==this.status&&(this.clearWatch(),this.status="PAUSED")},K.prototype.restart=function(){this.status="WATCHING",window.__AES_AUTOLOG_EXP__.pubSub.publish(y.EXP_CONFIG_CHANGE)},K.prototype.getStatus=function(){return this.status},K.prototype.addExposureListener=function(t){var e=this;if(function(t){return t.selectorFunc?"function"==typeof t.selectorFunc||(B("config.selectorFunc 类型应该为函数"),!1):!!t.selector||(B("config.selector 和 config.selectorFunc必须有一个"),!1)}(t)){var r=new j(t);return this.listenerMap.set(r.token,r),this.isAddThrottling||(this.isAddThrottling=!0,setTimeout((function(){e.isAddThrottling=!1,window.__AES_AUTOLOG_EXP__.pubSub.publish(y.EXP_CONFIG_CHANGE)}),30)),r.token}},K.prototype.removeExposureListener=function(t){var e=this;this.listenerMap.has(t)&&(this.listenerMap.delete(t),this.watchElemetMap.forEach((function(r,n){r.listenerMap.has(t)&&r.listenerMap.delete(t),r.listenerMap.size||(r.dom&&r.observerMap.forEach((function(t){var n=e.observerMap.get(t);n&&n.unobserve(r.dom)})),e.watchElemetMap.delete(n))})))};var $=function(){this.handlerMap=new F};$.prototype.subscribe=function(t,e){if(Q(e)){var r=this.handlerMap.get(t);r?r.push(e):this.handlerMap.set(t,[e])}},$.prototype.unsubscribe=function(t,e){if(Q(e)){var r=this.handlerMap.get(t);if(!r)return this;if(r.length&&e)for(var n=0;n<r.length;n++){var o=r[n];o&&e.toString()===o.toString()&&r.splice(n,1)}else this.handlerMap.delete(t)}},$.prototype.subscribeOnce=function(t,e){var r=this;if(Q(e)){return this.subscribe.call(this,t,(function n(){r.unsubscribe.call(r,t,n);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];e.apply(r,i)})),this}},$.prototype.publish=function(t){for(var e=this,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return window.queueMicrotask?window.queueMicrotask((function(){var r=e.handlerMap.get(t)||[];r.length>0&&r.forEach((function(r){"function"==typeof r&&r.apply(e,[t].concat(n))}))})):setTimeout((function(){var r=e.handlerMap.get(t)||[];r.length>0&&r.forEach((function(r){"function"==typeof r&&r.apply(e,[t].concat(n))}))}),0),this},$.prototype.clearAllSubscriptions=function(){this.handlerMap.clear()};var J=!1;!function(t){if(J||window.__AES_AUTOLOG_EXP__&&window.__AES_AUTOLOG_EXP__.dispatcher)X("already inited");else{window.__AES_AUTOLOG_EXP__={globalConfig:t,cacheSelectorNameMap:{},pubSub:new $};var e=new K;window.__AES_AUTOLOG_EXP__.dispatcher=e,J=!0}}();var Z=function(t){var e;if(null!=(e=window.__AES_AUTOLOG_EXP__)&&e.dispatcher)return window.__AES_AUTOLOG_EXP__.dispatcher.addExposureListener(t)},tt=function(t){if(window.URLSearchParams)return function(t){var e=window.URLSearchParams,r={};try{new e(t).forEach((function(t,e){r[e]=t}))}catch(t){console.error(t)}return r}(t);var e={};try{if("string"!=typeof t||0===t.length)return e;for(var r=t.split("&"),n=r.length,o=0;o<n;++o){var i,a,s,u,c=r[o]||"",l=c.indexOf("=");l>=0?(i=c.substr(0,l),a=c.substr(l+1)):(i=c,a=""),s=decodeURIComponent(i),u=decodeURIComponent(a),e[s]=u}}catch(t){console.error(t)}return e},et=function(t,e){return t.exp===e||t.exposure===e},rt=function(t){t.expToken&&(!function(t){var e;if(null!=(e=window.__AES_AUTOLOG_EXP__)&&e.dispatcher)window.__AES_AUTOLOG_EXP__.dispatcher.removeExposureListener(t)}(t.expToken),t.expToken=void 0)},nt=window.getComputedStyle?window.__aes_plugin_autolog_singleton?(console.warn("[aes-autolog] 已被载入，请勿重复载入"),!1):(window.__aes_plugin_autolog_singleton=!0,!0):(console.warn("[aes-autolog] 在当前环境下无法使用"),!1),ot=["button","checkbox","link","menuitem","radio","tab","combobox","search"],it=function(t,e){var r=e.autologProps.map((function(r){var n=t.getAttribute(r);if(n)return e.autologPropsHandler(n,r)})).filter(Boolean)[0]||{};return!!u(r).length?r:void 0},at={name:"builtin",prioritizedRules:[{selector:function(t){var e=t.info,r=t.source,n=t.config,o=n.containerProps;if(o&&0!==o.length){var i=e.reversedDOMArray.filter((function(t){return o.map((function(e){return t.getAttribute(e)})).filter(Boolean)[0]}))[0];if(i){var a=it(i,n);if(a&&"false"!==a.whole)return i}return r}},action:function(t){var e,r,n=t.target,o=t.config,i=t.source,a=t.info,s=t.logType;if(n!==i)e=n;else{var u=a.reversedDOMArray;e=u.filter((function(t){return o.containerProps.map((function(e){return t.getAttribute(e)})).filter(Boolean)[0]}))[0]}if((e&&(r=o.containerProps.map((function(t){return e&&e.getAttribute(t)})).filter(Boolean)[0]||""),"EXP"===s&&e&&e===i)&&!it(e,o))return{container:r,feature:"custom",text:r,xpath:a.xpath,__continue:!1};return{container:r,__continue:!0}}},{selector:function(t,e){var r=t.info,n=t.config,o=t.source,i=t.isByManual,a=r.reversedDOMArray.slice(0,5).filter((function(t){return n.autologProps.map((function(e){return t.getAttribute(e)})).filter(Boolean)[0]}))[0];if(!a&&!i){var s=e.getConfig(),u=(n.autologProps.map((function(t){var e=o.getAttribute(t);if(e)return n.autologPropsHandler(e,t)})).filter(Boolean)[0]||{}).clk;if("all"!==s.click||"false"==u)return o}return a},action:function(t,e){var r=t.source,n=t.target,o=t.config,i=t.logType,a=t.isByManual;if(r===n){var s=!0,c=o.autologProps.map((function(t){var e=n.getAttribute(t);if(e)return o.autologPropsHandler(e,t)})).filter(Boolean)[0],l=c||{},f=l.feature,d=l.text,h=l.xpath,p=l.clk,g=l.extra;if("CLK"===i&&!a){var v=e.getConfig();"false"===p?s=!1:"auto"===v.click?s=!!c:"manual"===v.click&&(s="true"===p)}return s?{feature:f||"custom",text:d,xpath:h,extra:g&&u(g).length>0?g:void 0,__continue:!d&&!f}:{__break:!0}}return{__restart:!0}}}],rules:[{selector:function(t){var e=t.info,r=t.source;if("img"===e.tagName)return r},action:function(t){var e=t.target,r=t.info,n=e.alt,o=r.reversedTagNameArray.indexOf("a");if(-1!==o)return{feature:"link",text:n};var i=-1!==o?"link":"image";return"pointer"===getComputedStyle(e).cursor&&(i="icon-button"),{feature:i,text:n}}},{selector:function(t){var e=t.info,r=t.source;if("area"===e.tagName)return r;var n=e.reversedTagNameArray.indexOf("a");return-1!==n?e.reversedDOMArray[n]:void 0},action:{feature:"link"}},{selector:function(t){var e=t.info,r=e.reversedTagNameArray.indexOf("button");if(-1!==r)return e.reversedDOMArray[r]},action:{feature:"button"}},{selector:function(t){var e=t.info,r=t.source;if("icon"===e.tagName)return r;var n=e.reversedTagNameArray.indexOf("svg");return-1!==n?e.reversedDOMArray[n]:void 0},action:function(t){var e=t.target;if("pointer"===getComputedStyle(e).cursor)return{feature:"icon-button",placeholder:"ICON_BUTTON"}}},{selector:function(t){var e=t.info,r=t.source,n=e.tagName;if("input"===n||"textarea"===n)return r},action:function(t){var e=t.target,r=t.info,n=e,o=n.type,i=n.value,a=n.placeholder,s={feature:""};return"text"!==o&&"password"!==o||(s.placeholder=a||""),"submit"===o||"button"===o?(s.feature="button",i&&(s.text=i)):s.feature=o||r.tagName,s}},{selector:function(t){var e=t.info,r=e.reversedTagNameArray.indexOf("label");if(-1!==r)return e.reversedDOMArray[r]},action:function(t){var e=t.target.getElementsByTagName("input")[0];if(e){var r=e.type;if("checkbox"===r||"radio"===r)return{feature:r}}}},{selector:function(t){var e=t.info,r=t.source;if("select"===e.tagName)return r},action:function(t){var e=t.target;return{feature:t.info.tagName,placeholder:e.placeholder}}},{selector:function(t){var e=t.source,r=e.getAttribute("role");if(r&&ot.indexOf(r)>-1)return e},action:function(t){var e=t.target.getAttribute("role");if(e&&ot.indexOf(e)>-1)return{feature:e}}},{selector:function(t){var e=t.source;if(e.getAttribute("data-spm-click"))return e},action:{feature:"custom",__continue:!0}},{selector:function(t){var e=t.source;if("pointer"===getComputedStyle(e).cursor)return e},action:{feature:"clickable"}}],defaultConfig:{containerProps:["data-autolog-container"],autologProps:["data-autolog","data-xux-log"],autologPropsHandler:function(t){var e=tt(t),r=e.feature,n=e.text,o=e.xpath,i=e.clk;return{feature:r,text:n,xpath:o,exp:e.exp,clk:i,extra:c(e,["feature","text","xpath","clk","exp","exposure"])}}}},st="START_LOAD_TO_AUTOLOG",ut="IN_AEM_CONTAINER",ct="PLUGIN_START",lt="START_LOAD_TO_AUTOLOG_FROM_PLUGIN",ft="READY_TO_LOAD_BY_AUTOLOG",dt="READY_TO_LOAD_BY_AUTOLOG_TO_PLUGIN",ht=function(t){var e=t.self,r=t.target,n=t.onMessage,o=function(t,e,r){var n=function(t){t.data&&"object"==typeof t.data&&1===t.data._aes_adata_msg_flag_&&setTimeout((function(){r(t.data,t)}),0)};return t.addEventListener("message",n,!1),{send:function(t,r){var n="function"==typeof e?e():e;n&&n.postMessage(s(t,{_aes_adata_msg_flag_:1}),r||"*")},destroy:function(){t.removeEventListener("message",n,!1)}}}(e,r,(function(t,e){n(t,e)})),i=o.send;return{send:function(t,e){i(t,e)},destroy:o.destroy}};!function(){try{if(window.parent&&window!==window.parent){window._aes_autolog_adata_loader_=!0;var t=ht({self:window,target:window.parent,onMessage:function(e,r){if(e.type===ut)t&&t.send({type:ft},r&&r.origin);else if(e.type===st){var n=e.payload&&e.payload.adataScriptUrl;if(n){window._aes_autolog_adata_plugin_version="3";var o=document.createElement("script");o.src=n,document.body.appendChild(o)}t&&t.destroy(),t=null}}})}}catch(t){console.error(t)}}(),function(){try{var t=ht({self:window,target:function(){var t=document.getElementById("aesAdataPluginIframe");return t&&t.contentWindow},onMessage:function(e,r){if(e.type===ct)t&&t.send({type:dt},r&&r.origin);else if(e.type===lt){if(window._aes_autolog_adata_plugin_loader_)return;var n=e.payload&&e.payload.adataScriptUrl;if(n){window._aes_autolog_adata_plugin_loader_=!0,window._aes_autolog_adata_plugin_version="3";var o=document.createElement("script");o.src=n,document.body.appendChild(o)}t&&t.destroy(),t=null}}}),e=ht({self:window,target:window,onMessage:function(t,r){"AES_ADATA_PLUGIN_LOAD"===t.type&&(e&&e.send({type:"HAS_AES_AUTOLOG_TO_PLUGIN"},r&&r.origin),e&&e.destroy(),e=null)}})}catch(t){console.error(t)}}();e.default=function(t,e){void 0===e&&(e={});var r={registry:[],ruleList:[],target:document,registeredListeners:{},getConfig:function(){return n(t,e)},getConfigByKey:function(r){return function(t,e,r){return n(t,e)[r]}(t,e,r)}};window.AES_ADATA_INSTANCE_PUSH_QUEUE=window.AES_ADATA_INSTANCE_PUSH_QUEUE||[],window.AES_ADATA_INSTANCE_PUSH_QUEUE.push((function(){return t}));var o=function(){var t=r.getConfigByKey("targetSelector"),e=t?document.querySelector(t):document;r.target=e||document},a=function(){var e=r.getConfig();o(),nt&&(function(t,e){var r=t.target,n=t.registeredListeners;if(N(t),S){var o,i=function(t){var e=t.touches,r=t.changedTouches;if(!(e&&1!==e.length||r&&1!==r.length)){var n=r[0],i=n.pageX,a=n.pageY;o={time:L(),pageX:i,pageY:a}}},a=function(t){var r=t.changedTouches;if((!r||1===r.length)&&o){var n=r[0],i=n.pageX,a=n.pageY,s=L()-o.time,u=o.pageX-i|0,c=o.pageY-a|0;s<500&&u*u+c*c<36&&e(t),o=void 0}};r.addEventListener("touchstart",i),r.addEventListener("touchend",a),n.touchstart=i,n.touchend=a}else r.addEventListener("mousedown",e),n.mousedown=e}(r,(function(n){if(!1!==e.click&&n.target&&n.target instanceof Element){var o=P(r,n.target,"CLK");o&&o.feature&&(e.debug&&(console.warn("[aes-autolog] 发送AES点击日志",o),window.validLog(o,"2.0"),window.validNewLog(o,n.target,t.getConfig())),e.dryRun||t.log("autolog",o))}})),function(t,e){var r,n;rt(t);var o,a,s=t.getConfig(),u=t.getConfigByKey("exposureSelector");!1!==s.exposure&&(t.expToken||(t.expToken=Z("function"!=typeof u?{selectorFunc:function(){var e=s.autologProps,r=void 0===e?[]:e,n=s.containerProps,o=void 0===n?[]:n;if(!r.length&&!o.length)return[];var a=[],u=r.map((function(t){return"["+t+"]"})).join(","),c=r.length?i(t.target.querySelectorAll(u)):[];if(o.length){var l=o.map((function(t){return"["+t+"]"})).join(",");i(t.target.querySelectorAll(l)).forEach((function(t){if(t.getAttribute&&r.length){var e=r.map((function(e){return t.getAttribute(e)})).filter(Boolean)[0];"auto"!==s.exposure||e||a.push(t)}}))}return c.forEach((function(t){if(t.getAttribute&&r.length){var e=r.map((function(e){return t.getAttribute(e)})).filter(Boolean)[0],n=e?tt(e):{};"auto"!==s.exposure||et(n,"false")?"manual"===s.exposure&&et(n,"true")&&a.push(t):a.push(t)}})),a},duration:(null==(r=s.exposureProps)?void 0:r.duration)||300,threshold:(null==(n=s.exposureProps)?void 0:n.areaThreshold)||.5,onExposure:function(t){var r=t.element;e(r)}}:{selectorFunc:function(){try{return u()||[]}catch(t){return console.error(t),[]}},duration:(null==(o=s.exposureProps)?void 0:o.duration)||300,threshold:(null==(a=s.exposureProps)?void 0:a.areaThreshold)||.5,onExposure:function(t){var r=t.element;e(r)}})))}(r,(function(n){if(n&&n instanceof Element){var o=P(r,n,"EXP");o&&o.feature&&(e.debug&&(console.warn("[aes-autolog] 发送AES曝光日志",o),window.validNewLog(o,n,t.getConfig())),e.dryRun||t.log("autolog",o))}})))};return function(){o();var t=r.getConfig();O(r,at,{autologProps:t.autologProps,autologPropsHandler:t.autologPropsHandler,containerProps:t.containerProps}),!1===t.autoLoad||!1===t.click&&!1===t.exposure||a()}(),{addPlugin:function(t,e,n){O(r,t,e,n)},removePlugin:function(t,e){T(r,t,e)},start:a,stop:function(){nt&&(N(r),rt(r))},autolog:function(e){void 0===e&&(e={});var n=r.getConfig(),o=e,i=o.target,a=o.feature,u=o.text,l=o.logType,f=void 0===l?"CLK":l,d=c(e,["target","feature","text","logType"]);if(!(i&&i instanceof Element))return console.error('Parameter "target" is not an Element!'),!1;var h=P(r,i,f,!0);if(h){var p=s(h,s({feature:a||h.feature,text:u||h.text},d));p&&p.feature&&(n.debug&&(console.warn("[aes-autolog] 发送AES日志",p),window.validLog(p,"2.0")),n.dryRun||t.log("autolog",p))}}}}}]).default}));